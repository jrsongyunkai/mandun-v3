webpackJsonp([19],{GudF:function(e,t){},yHbH:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("IcnI"),i=a("P9l9"),n=a("z3YC"),o=a("BPrN"),r=a("SPzd"),l={data:function(){return{datePicker:"day",dateType:1,date:"",value:this.$func.getNowFormatDate(),month:this.$func.getCurrentYearMonth(),form:{mac:""},tableData:[],pageNo:1,pageSize:10,currentPage:1,total:0,flag:!0,loading:!1,activeName:"first",alarmOption:{legendStatus:!1,xAxis:[],series:[],title:{show:!1},tooltip:{show:!1}},warnOption:{legendStatus:!1,xAxis:[],series:[],title:{show:!1},tooltip:{show:!1}},detailsFlag:!1,detailsObj:{others:{version:"",online:""}},detailsValue:"",alarmInfo:[],maintenanceBoxObj:{},dialogVisible:!1,tableComponentHeight:this.$store.state.innerTableHeight}},mounted:function(){this.init()},methods:{init:function(){this.activeName=this.$store.state.warnTab,this.form.mac=this.$store.state.warnMac,this.datePicker=this.$store.state.warnDatePicker,this.dateType=this.$store.state.warnDateType,this.pageNo=this.$store.state.warnPageNo,this.value=""===this.$store.state.warnDay?this.$func.getNowFormatDate():this.$store.state.warnDay,this.month=""===this.$store.state.warnMonth?this.$func.getCurrentYearMonth():this.$store.state.warnMonth,1===this.dateType?this.date=this.value:this.date=this.month,this.queryPowerAlarm(),this.queryList()},handle:function(e){var t=this;Object(i._106)({mac:e.mac}).then(function(e){e.success?(t.detailsObj=e.data,s.a.commit("mac",t.detailsObj.mac),s.a.commit("equipmentType",t.detailsObj.equipmentType),6===t.detailsObj.equipmentType||7===t.detailsObj.equipmentType?t.detailsValue=t.$func.getCurrentYearMonth():t.detailsValue=t.$func.getNowFormatDate(),s.a.commit("historyDate",t.detailsValue),t.detailsFlag=!0,t.handleModifyMacRate(t.detailsObj.mac,!0)):"-1"===e.code||t.$message({message:e.message,type:"error"})}).catch(function(e){e&&t.$message({message:t.$t("message.unknown"),type:"error"})})},handleDateChange:function(e){this.value=e,s.a.commit("historyDate",e)},handleDetailsClose:function(){6===this.detailsObj.equipmentType||7===this.detailsObj.equipmentType?(this.detailsValue=this.$func.getCurrentYearMonth(),s.a.commit("historyDate",this.$func.getCurrentYearMonth())):(this.detailsValue=this.$func.getNowFormatDate(),s.a.commit("historyDate",this.$func.getNowFormatDate())),s.a.commit("detailsAddr",""),this.handleModifyMacRate(this.$store.state.mac,!1),s.a.dispatch("resetMac"),this.detailsFlag=!1},handleModifyMacRate:function(e,t){if(!e)return!1;Object(i._82)({fastMac:!0===t?e:"",slowMac:!0===t?"":e})},queryPowerAlarm:function(){var e=this;this.loading=!0;var t={typeNumbers:"first"===this.activeName?-100:-200,dateType:this.dateType,date:this.date?this.date:this.$func.getNowFormatDate(),mac:this.form.mac.trim(),projectCode:this.$store.state.projectCode};Object(i._93)(t).then(function(t){if(e.flag=!0,t.success){var a=e;e.alarmOption.xAxis=[],e.alarmOption.series=[],e.warnOption.xAxis=[],e.warnOption.series=[];var s={value:[],legend:[],typeNos:[]},i={value:[],legend:[],typeNos:[]};t.data.forEach(function(e,t){-1!==[1,2,3,4,5,6,7,8,11,17,18,19,1007,1008,1009].indexOf(e.typeNumber)?4===e.typeNumber||1008===e.typeNumber?s.typeNos.forEach(function(t,i){3===t&&(s.value[i]+=e.number,a.alarmOption.xAxis[i]=a.$t("types.overloadOvercurrent"))}):18===e.typeNumber||19===e.typeNumber?s.typeNos.forEach(function(t,i){17===t&&(s.value[i]+=e.number,a.alarmOption.xAxis[i]=a.$t("types.threePhaseA"))}):1009===e.typeNumber?s.typeNos.forEach(function(t,i){7===t&&(s.value[i]+=e.number,a.alarmOption.xAxis[i]=a.$t("types.temperatureA"))}):1007===e.typeNumber?s.typeNos.forEach(function(t,i){5===t&&(s.value[i]+=e.number,a.alarmOption.xAxis[i]=a.$t("types.overpressureA"))}):("短路报警"===e.info?e.info=a.$t("types.shortCircuitA"):"漏电报警"===e.info?e.info=a.$t("types.leakageA"):"过压报警"===e.info?e.info=a.$t("types.overpressureA"):"欠压报警"===e.info?e.info=a.$t("types.undervoltageA"):"温度报警"===e.info?e.info=a.$t("types.temperatureA"):"浪涌报警"===e.info?e.info=a.$t("types.surgeA"):"电弧报警"===e.info&&(e.info=a.$t("types.fireA")),s.value.push(e.number),s.typeNos.push(e.typeNumber),a.alarmOption.xAxis.push(e.info)):("漏保功能正常"===e.info?e.info=a.$t("types.leakageProtectionNormal"):"漏保自检未完成"===e.info||"漏电保护自检未完成"===e.info?e.info=a.$t("types.leakageProtectionSelfTestNotCompleted"):"漏电预警"===e.info?e.info=a.$t("types.leakageW"):"电流预警"===e.info?e.info=a.$t("types.currentW"):"过压预警"===e.info?e.info=a.$t("types.overpressureW"):"欠压预警"===e.info?e.info=a.$t("types.undervoltageW"):"通讯预警"===e.info&&(e.info=a.$t("types.communicationA")),1001!==e.typeNumber&&(i.value.push(e.number),i.typeNos.push(e.typeNumber),a.warnOption.xAxis.push(e.info)))}),e.alarmOption.series.push({type:"bar",barMaxWidth:"30",data:s.value,itemStyle:{normal:{color:function(e){return["#cb3f40","#f26665","#f2a5a6","#9a39b4","#c077cd","#d19edc","#e79c28","#f0c647 ","#fee7a2"][e.dataIndex]},label:{show:!0,position:"top",textStyle:{color:"#fff"}}}}}),e.warnOption.series.push({type:"bar",barMaxWidth:"30",data:i.value,itemStyle:{normal:{color:function(e){return["#cb3f40","#f26665","#f2a5a6","#9a39b4","#c077cd","#d19edc","#e79c28","#f0c647 ","#fee7a2"][e.dataIndex]},label:{show:!0,position:"top",textStyle:{color:"#fff"}}}}}),e.flag=!0}else"-1"===t.code||e.$message({message:t.message,type:"error"})}).catch(function(t){e.$message({message:e.$t("message.unknown"),type:"error"})})},queryList:function(e){this.loading=!0;var t={page:this.pageNo,rows:this.pageSize,dateType:this.dateType,date:this.date?this.date:this.$func.getNowFormatDate(),mac:this.form.mac.trim(),typeNumbers:"first"===this.activeName?-100:-200,projectCode:this.$store.state.projectCode};this.$nextTick(function(){var e=this;Object(i.i)(t).then(function(t){t.success?(e.tableData=t.datas,e.total=t.total,e.currentPage=e.pageNo):"-1"===t.code||e.$message({message:t.message,type:"error"})}).catch(function(t){t&&e.$message({message:e.$t("message.unknown"),type:"error"})}).finally(function(){e.loading=!1})})},handleSizeChange:function(e){this.pageSize=e,this.queryList()},handleCurrentChange:function(e){this.pageNo=e,s.a.commit("warnPageNo",e),this.queryList()},handleDayPicker:function(e){s.a.commit("warnDateType",1),s.a.commit("warnDay",e),s.a.commit("warnPageNo",1),this.dateType=1,this.date=e,this.value=e,this.init()},handleMonthPicker:function(e){s.a.commit("warnDateType",2),s.a.commit("warnMonth",e),s.a.commit("warnPageNo",1),this.dateType=2,this.date=e,this.month=e,this.init()},handleDatePicker:function(e){"day"===e?(this.dateType=1,s.a.commit("warnDateType",1),this.date=this.value):"month"===e&&(this.dateType=2,s.a.commit("warnDateType",2),this.date=this.month),this.datePicker=e,s.a.commit("warnPageNo",1),s.a.commit("warnDatePicker",e),this.init()},handleExport:function(){this.$func.windowCountDown(ctxPaths+"/project/main/v2/xls/alarmDetailOfProject.as?typeNumbers=0&dateType="+this.dateType+"&date="+(1===this.dateType?this.value:this.month)+"&projectCode="+this.$store.state.projectCode+"&oqp1="+this.$store.state.projectName+"&mac="+this.form.mac.trim())},onSubmit:function(){s.a.commit("warnMac",this.form.mac),this.init()},handleValue:function(e){var t="",a="";1===e.elecType?t=this.$t("main.watt"):2===e.elecType?t=this.$t("main.ampere"):3===e.elecType?t=this.$t("menu.leakageCurrent"):4===e.elecType?t=this.$t("menu.temperature"):5===e.elecType?t=this.$t("main.volt"):8===e.elecType?t=this.$t("main.lightningCurrent"):9===e.elecType?(a=this.$t("control.signal"),t=this.$t("main.volt")):10===e.elecType?t=this.$t("menu.humidity"):11===e.elecType?t=this.$t("stralsund.concentration"):12===e.elecType?t=this.$t("echarts.illumination")+this.$t("echarts.celsius"):14===e.elecType&&(t=this.$t("table.waterVolume")),9===e.elecType?this.alarmInfo=[t+"("+e.unit1+"): "+e.value1+", "+a+"("+e.unit2+"): "+e.value2]:8===e.elecType?this.alarmInfo=[t+"("+e.unit+"): "+e.value+" "+(8===e.elecType?"":"("+this.$t("table.threshold")+":"+e.threshold+")"),void 0!==e.groundWire?this.$t("main.groundState")+": "+(0===e.groundWire?this.$t("control.normal"):this.$t("control.abnormal")):"",void 0!==e.spd?"SPD: "+(0===e.spd?this.$t("control.normal"):this.$t("control.abnormal")):"",e.occurTime?this.$t("main.surgeTime")+": "+(e.occurTime?e.occurTime:""):""]:10===e.elecType?this.alarmInfo=t+": "+e.value+e.unit+"RH ("+this.$t("table.threshold")+":"+e.threshold+")":11===e.elecType?this.alarmInfo=t+": "+e.value+e.unit+" ("+this.$t("table.threshold")+":"+e.threshold+")":12===e.elecType?this.alarmInfo=t+": "+e.value+"Lux("+this.$t("table.threshold")+":"+e.threshold+")":14===e.elecType?this.alarmInfo=t+": "+(e.value1+e.unit1):this.alarmInfo=t+": "+e.value+e.unit+" ("+this.$t("table.threshold")+":"+e.threshold+")"},handleClick:function(e,t){s.a.commit("warnTab",e.name),this.init()},queryMaintenance:function(e){var t=this,a={mac:e.mac,alarmId:e.id,id:""};Object(i._19)(a).then(function(a){a.success?(s.a.commit("maintenanceObj",a.data),s.a.commit("alarmId",e.id),t.maintenanceBoxObj=e,t.dialogVisible=!0):"-1"===a.code||t.$message({message:a.message,type:"error"})}).catch(function(e){t.$message({message:t.$("message.unknown"),type:"error"})})},closeMaintenance:function(){s.a.dispatch("resetMaintenanceObj"),this.dialogVisible=!1,this.init()},handleUrge:function(e){var t=this;Object(i.m)({id:e}).then(function(e){t.$message({message:e.message,type:"0"===e.code?"success":"error"})}).catch(function(e){e&&t.$message({message:t.$t("message.unknown"),type:"error"})})}},watch:{"$store.state.projectCode":{handler:function(e,t){e&&"/InnerMain/Warn"===this.$route.path&&this.init()},deep:!0},"$store.state.innerTableHeight":{handler:function(e,t){e&&(this.tableComponentHeight=e)}}},components:{BarCharts:o.a,Details:n.a,MaintenanceBox:r.a}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:e.flag,expression:"flag"}],attrs:{id:"warn"}},[a("el-row",{staticClass:"pickDate"},[[a("div",{staticClass:"block"},[a("i",{staticClass:"el-icon-printer export-icon",class:"en"===e.$i18n.locale?"en-export":"",on:{click:e.handleExport}})]),e._v(" "),a("div",{staticClass:"block"},[a("el-form",{ref:"form",attrs:{model:e.form,size:"small"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",[a("el-input",{staticClass:"short-input",attrs:{placeholder:e.$t("placeholder.enterDeviceNo")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit(t)}},model:{value:e.form.mac,callback:function(t){e.$set(e.form,"mac",t)},expression:"form.mac"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(e._s(e.$t("btns.query")))])],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"day"===e.datePicker,expression:"datePicker === 'day'"}],staticClass:"block",class:"en"===e.$i18n.locale?"en-datePicker":""},[a("span",{staticClass:"demonstration"},[e._v(e._s(e.$t("main.date")))]),e._v(" "),a("el-date-picker",{attrs:{type:"date",size:"small",editable:!1,"value-format":"yyyy-MM-dd"},on:{change:e.handleDayPicker},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"month"===e.datePicker,expression:"datePicker === 'month'"}],staticClass:"block",class:"en"===e.$i18n.locale?"en-datePicker":""},[a("span",{staticClass:"demonstration"},[e._v(e._s(e.$t("main.date")))]),e._v(" "),a("el-date-picker",{attrs:{"value-format":"yyyy-MM",type:"month",size:"small",editable:!1},on:{change:e.handleMonthPicker},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}})],1)],e._v(" "),a("div",{staticClass:"block"},[a("el-button",{attrs:{size:"small",type:"day"===e.datePicker?"success":"info",circle:""},on:{click:function(t){return e.handleDatePicker("day")}}},[e._v(e._s(e.$t("main.day")))]),e._v(" "),a("el-button",{attrs:{size:"small",type:"month"===e.datePicker?"success":"info",circle:""},on:{click:function(t){return e.handleDatePicker("month")}}},[e._v(e._s(e.$t("main.month")))])],1)],2),e._v(" "),a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"padding-10-lr",attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, .2)","element-loading-text":e.$t("message.loading")}},[a("el-tabs",{attrs:{id:"power-alarm-wrap"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$t("home.powerAlarm"),name:"first"}},["first"===e.activeName&&"/InnerMain/Warn"===e.$route.path?a("bar-charts",{staticClass:"power-alarm",attrs:{options:e.alarmOption}}):e._e()],1),e._v(" "),a("el-tab-pane",{attrs:{label:e.$t("home.powerWarning"),name:"second"}},["second"===e.activeName&&"/InnerMain/Warn"===e.$route.path?a("bar-charts",{staticClass:"power-alarm",attrs:{options:e.warnOption}}):e._e()],1)],1),e._v(" "),a("el-col",[a("el-table",{directives:[{name:"el_scrollBar",rawName:"v-el_scrollBar:scrollBar",arg:"scrollBar"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"small",height:e.tableComponentHeight,"max-height":e.tableComponentHeight}},[a("el-table-column",{attrs:{prop:"id",align:"center",label:e.$t("table.jobNumber")}}),e._v(" "),a("el-table-column",{attrs:{prop:"address",align:"center",label:e.$t("table.location")}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:e.$t("table.deviceNo"),width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"c-default pointer",on:{click:function(a){return e.handle(t.row)}}},[e._v(e._s(t.row.mac))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"channel",align:"center",label:e.$t("table.line"),width:"60px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"info",align:"center",label:e.$t("table.alarmType")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{effect:"dark",content:t.row.info,placement:"right"}},[a("span",[e._v(e._s(t.row.info))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"time",align:"center",label:e.$t("table.alarmTime"),width:"140px"}}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.schedule")},scopedSlots:e._u([{key:"default",fn:function(e){return[e.row.progress>100?a("el-progress",{class:2===e.row.processStatus?"solved":"rejected",attrs:{"text-inside":!0,"stroke-width":18,"show-text":!1,percentage:100}}):a("el-progress",{class:2===e.row.processStatus?"solved":"rejected",attrs:{"text-inside":!0,"stroke-width":18,"show-text":!1,percentage:e.row.progress}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.timeConsuming"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:"48"===t.row.passTime?"danger-text":"warning-text"},[e._v(e._s(t.row.passTime+e.$t("table.hour")))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"processStatus",label:e.$t("table.status"),align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.processStatus?a("el-button",{staticClass:"fs-12",attrs:{type:"text"},on:{click:function(a){return e.handleUrge(t.row.id)}}},[e._v(e._s(e.$t("table.urge")))]):e._e(),e._v(" "),a("span",{staticClass:"pointer",class:0===t.row.processStatus?"c-danger":"c-success",on:{click:function(a){return e.queryMaintenance(t.row)}}},[e._v(e._s(0===t.row.processStatus?e.$t("home.unprocessed"):e.$t("home.processed")))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("home.value"),align:"center",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{placement:"top",width:"250",trigger:"click",content:e.alarmInfo}},[a("i",{directives:[{name:"show",rawName:"v-show",value:""!==t.row.valueDescribe&&"{}"!==JSON.stringify(t.row.valueDescribe),expression:"scope.row.valueDescribe !== '' && JSON.stringify(scope.row.valueDescribe) !== '{}'"}],staticClass:"el-icon-news",attrs:{slot:"reference"},on:{click:function(a){return e.handleValue(t.row.valueDescribe)}},slot:"reference"})])]}}])})],1),e._v(" "),a("el-col",{staticClass:"mt-10 tc",attrs:{span:24}},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30],"page-size":e.pageSize,small:!0,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.$t("control.maintenance")+e.$t("control.edit"),"close-on-click-modal":!1,visible:e.dialogVisible,"append-to-body":"",modal:!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.closeMaintenance}},[e.dialogVisible?a("MaintenanceBox",{attrs:{maintenanceBoxObj:e.maintenanceBoxObj},on:{"close-maintenance":e.closeMaintenance}}):e._e()],1),e._v(" "),a("el-dialog",{attrs:{title:e.$t("control.device")+e.$t("control.details"),"close-on-click-modal":!1,"custom-class":"details-dialog",modal:!1,width:"1323px","lock-scroll":"false",visible:e.detailsFlag,"before-close":e.handleDetailsClose},on:{"update:visible":function(t){e.detailsFlag=t}}},[a("span",{directives:[{name:"show",rawName:"v-show",value:1!==e.detailsObj.others.online,expression:"detailsObj.others.online !== 1"}],staticClass:"offline-attention c-danger",class:"zh"===this.$i18n.locale?"":"en-offline-attention"},[e._v(e._s(e.$t("control.offlineAttention")))]),e._v(" "),a("div",{staticClass:"date-picker"},[a("el-button",{attrs:{type:"success",circle:"",size:"mini"}},[e._v(e._s(6===e.detailsObj.equipmentType||7===e.detailsObj.equipmentType?e.$t("main.month"):e.$t("main.day")))]),e._v(" "),a("span",[e._v(e._s(e.$t("main.date")))]),e._v(" "),a("el-date-picker",{staticStyle:{width:"135px"},attrs:{type:6===e.detailsObj.equipmentType||7===e.detailsObj.equipmentType?"month":"date",size:"small",disabled:e.$store.state.dateFlag,editable:!1,"value-format":6===e.detailsObj.equipmentType||7===e.detailsObj.equipmentType?"yyyy-MM":"yyyy-MM-dd",placeholder:e.$t("placeholder.pleaseChoose")+e.$t("main.date")},on:{change:e.handleDateChange},model:{value:e.detailsValue,callback:function(t){e.detailsValue=t},expression:"detailsValue"}})],1),e._v(" "),a("el-scrollbar",{staticStyle:{height:"100%"}},[e.detailsFlag?a("Details",{attrs:{param:e.detailsObj}}):e._e()],1)],1)],1)},staticRenderFns:[]};var m=a("VU/8")(l,c,!1,function(e){a("GudF")},"data-v-6ecb14bd",null);t.default=m.exports}});